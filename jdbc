import java.sql.*;
import java.util.*;

class Student {
    int id;
    String name, dept;
    double marks;
    Student(int id, String name, String dept, double marks) {
        this.id = id; this.name = name; this.dept = dept; this.marks = marks;
    }
}

class DatabaseController {
    private static final String URL = "jdbc:mysql://localhost:3306/testdb";
    private static final String USER = "root";
    private static final String PASS = "password";
    Connection con;
    DatabaseController() throws Exception {
        Class.forName("com.mysql.cj.jdbc.Driver");
        con = DriverManager.getConnection(URL, USER, PASS);
    }
    void fetchEmployees() throws Exception {
        Statement st = con.createStatement();
        ResultSet rs = st.executeQuery("SELECT * FROM Employee");
        while(rs.next()) System.out.println(rs.getInt(1)+" "+rs.getString(2)+" "+rs.getDouble(3));
    }
    void createProduct(int id, String name, double price, int qty) throws Exception {
        con.setAutoCommit(false);
        PreparedStatement ps = con.prepareStatement("INSERT INTO Product VALUES(?,?,?,?)");
        ps.setInt(1,id); ps.setString(2,name); ps.setDouble(3,price); ps.setInt(4,qty);
        ps.executeUpdate(); con.commit();
    }
    void readProducts() throws Exception {
        Statement st = con.createStatement();
        ResultSet rs = st.executeQuery("SELECT * FROM Product");
        while(rs.next()) System.out.println(rs.getInt(1)+" "+rs.getString(2)+" "+rs.getDouble(3)+" "+rs.getInt(4));
    }
    void updateProduct(int id, double price) throws Exception {
        con.setAutoCommit(false);
        PreparedStatement ps = con.prepareStatement("UPDATE Product SET Price=? WHERE ProductID=?");
        ps.setDouble(1,price); ps.setInt(2,id);
        ps.executeUpdate(); con.commit();
    }
    void deleteProduct(int id) throws Exception {
        con.setAutoCommit(false);
        PreparedStatement ps = con.prepareStatement("DELETE FROM Product WHERE ProductID=?");
        ps.setInt(1,id); ps.executeUpdate(); con.commit();
    }
    void addStudent(Student s) throws Exception {
        PreparedStatement ps = con.prepareStatement("INSERT INTO Student VALUES(?,?,?,?)");
        ps.setInt(1,s.id); ps.setString(2,s.name); ps.setString(3,s.dept); ps.setDouble(4,s.marks);
        ps.executeUpdate();
    }
    void viewStudents() throws Exception {
        Statement st = con.createStatement();
        ResultSet rs = st.executeQuery("SELECT * FROM Student");
        while(rs.next()) System.out.println(rs.getInt(1)+" "+rs.getString(2)+" "+rs.getString(3)+" "+rs.getDouble(4));
    }
    void updateStudent(int id, double marks) throws Exception {
        PreparedStatement ps = con.prepareStatement("UPDATE Student SET Marks=? WHERE StudentID=?");
        ps.setDouble(1,marks); ps.setInt(2,id); ps.executeUpdate();
    }
    void deleteStudent(int id) throws Exception {
        PreparedStatement ps = con.prepareStatement("DELETE FROM Student WHERE StudentID=?");
        ps.setInt(1,id); ps.executeUpdate();
    }
}

public class JDBCApp {
    public static void main(String[] args) throws Exception {
        Scanner sc = new Scanner(System.in);
        DatabaseController db = new DatabaseController();
        System.out.println("1.Fetch Employees 2.CRUD Product 3.MVC Student 0.Exit");
        while(true) {
            System.out.print("Enter choice: ");
            int ch = sc.nextInt();
            if(ch==0) break;
            switch(ch) {
                case 1: db.fetchEmployees(); break;
                case 2:
                    System.out.println("1.Create 2.Read 3.Update 4.Delete");
                    int c=sc.nextInt();
                    if(c==1){System.out.print("ID Name Price Qty: ");db.createProduct(sc.nextInt(),sc.next(),sc.nextDouble(),sc.nextInt());}
                    else if(c==2) db.readProducts();
                    else if(c==3){System.out.print("ID NewPrice: ");db.updateProduct(sc.nextInt(),sc.nextDouble());}
                    else if(c==4){System.out.print("ID: ");db.deleteProduct(sc.nextInt());}
                    break;
                case 3:
                    System.out.println("1.Add 2.View 3.Update 4.Delete");
                    int s=sc.nextInt();
                    if(s==1){System.out.print("ID Name Dept Marks: ");Student st=new Student(sc.nextInt(),sc.next(),sc.next(),sc.nextDouble());db.addStudent(st);}
                    else if(s==2) db.viewStudents();
                    else if(s==3){System.out.print("ID NewMarks: ");db.updateStudent(sc.nextInt(),sc.nextDouble());}
                    else if(s==4){System.out.print("ID: ");db.deleteStudent(sc.nextInt());}
                    break;
            }
        }
        sc.close();
    }
}
